import{D as e,b as t,c as i}from"./vue-vendor-DpnofNfo.js";import{m as s}from"./index-kUCeoXe8.js";import"./firebase-vendor-B7qOPrSY.js";import"./vuetify-vendor-BWjtgv5e.js";const n="shoppingLists",d=()=>{const e=localStorage.getItem("user");if(!e)return null;try{const t=JSON.parse(e);return t?.email||null}catch{return null}},r=e=>{const t=d();return t?`${e}_${t}`:e},o=()=>{if(!d())return[];const e=r(n),t=localStorage.getItem(e);if(!t)return[];try{return JSON.parse(t)}catch{return[]}},c=e=>{if(!d())return;const t=r(n);localStorage.setItem(t,JSON.stringify(e))},u=e("shopping",(()=>{const e=t([]),n=t(null),d=i((()=>e.value.filter((e=>!e.converted)))),r=i((()=>e.value.filter((e=>e.converted)))),u=i((()=>n.value&&e.value.find((e=>e.id===n.value))||null)),l=()=>{e.value=o()},a=e=>{(e=>{const t=o(),i=t.findIndex((t=>t.id===e.id));-1!==i&&(t[i]=e,c(t))})(e),l(),s.queueBackup()};return l(),{shoppingLists:e,selectedListId:n,unconvertedLists:d,convertedLists:r,selectedList:u,loadShoppingLists:l,addShoppingList:e=>{(e=>{const t=o();t.push(e),c(t)})(e),l(),s.queueBackup()},updateShoppingList:a,deleteShoppingList:e=>{(e=>{const t=o().filter((t=>t.id!==e));c(t)})(e),l(),s.queueBackup()},markListAsConverted:(t,i)=>{const s=e.value.find((e=>e.id===t));s&&(s.converted=!0,s.expenseId=i,a(s))},setSelectedList:e=>{n.value=e},addItemToList:(e,t)=>{((e,t)=>{const i=o(),s=i.find((t=>t.id===e));s&&(s.items.push(t),c(i))})(e,t),l(),s.queueBackup()},updateItemInList:(e,t)=>{((e,t)=>{const i=o(),s=i.find((t=>t.id===e));if(s){const e=s.items.findIndex((e=>e.id===t.id));-1!==e&&(s.items[e]=t,c(i))}})(e,t),l(),s.queueBackup()},deleteItemFromList:(e,t)=>{((e,t)=>{const i=o(),s=i.find((t=>t.id===e));s&&(s.items=s.items.filter((e=>e.id!==t)),c(i))})(e,t),l(),s.queueBackup()},toggleItemChecked:(t,i)=>{const s=e.value.find((e=>e.id===t));if(s){const e=s.items.find((e=>e.id===i));e&&(e.checked=!e.checked,e.checkedAt=e.checked?(new Date).toISOString():null,a(s))}},reorderItems:(t,i)=>{const s=e.value.find((e=>e.id===t));if(s){const e=s.items.filter((e=>e.checked)),t=new Map(s.items.filter((e=>!e.checked)).map((e=>[e.id,e]))),n=i.map((e=>t.get(e))).filter(Boolean);s.items=[...n,...e],a(s)}}}}));export{u as useShoppingStore};
